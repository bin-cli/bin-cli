#!/usr/bin/env bash
set -euo pipefail
cd "$(dirname "$0")/../.."

page=${1-bin.1}
version=${2-v1.2.3}

mkdir -p temp/pages

sed -E "s/\\\$VERSION/$version/g" "src/$page.md" |
    # '+hard_line_breaks' preserves line breaks in the source file
    # '-raw_html' so we don't have to escape '<root>', for example
    # '-smart' prevents '--' being converted to an en-dash
    # Clearing the 'title' var so no <h1> is generated but <title> is still set
    pandoc \
        --standalone \
        --from markdown+hard_line_breaks-raw_html-smart \
        --to html \
        --css 'pandoc.css' \
        --variable title='' \
    > "temp/pages/$page.html"

